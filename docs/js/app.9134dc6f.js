(function(e){function t(t){for(var n,o,a=t[0],r=t[1],c=t[2],f=0,d=[];f<a.length;f++)o=a[f],Object.prototype.hasOwnProperty.call(l,o)&&l[o]&&d.push(l[o][0]),l[o]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],n=!0,a=1;a<s.length;a++){var r=s[a];0!==l[r]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=s[0]))}return e}var n={},l={app:0},i=[];function o(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=n,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(s,n,function(t){return e[t]}.bind(null,n));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],r=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var u=r;i.push([1,"chunk-vendors"]),s()})({0:function(e,t){},"034f":function(e,t,s){"use strict";s("85ec")},1:function(e,t,s){e.exports=s("56d7")},2:function(e,t){},3:function(e,t){},"3d08":function(e,t,s){"use strict";s("8cd1")},"41a0":function(e,t,s){"use strict";s("6fd0")},5276:function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("0fae");var n=s("9e2f"),l=s.n(n),i=(s("e260"),s("e6cf"),s("cca6"),s("a79d"),s("2b0e")),o=s("8c4f"),a=s("2f62"),r=s("3ed6"),c=s.n(r),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.loading?n("div",[n("img",{attrs:{width:"50%",src:s("d4f9")}})]):e._e(),n("router-view",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}]})],1)},f=[],d={name:"App",data:function(){return{loading:!0}},created:function(){this.starting()},methods:{starting:function(){setTimeout(this.onLoad,2e3)},onLoad:function(){this.loading=!1}}},h=d,p=(s("034f"),s("2877")),m=Object(p["a"])(h,u,f,!1,null,null,null),y=m.exports,g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("CompararPlanillas")],1)},b=[],v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"com-planillas-container"},[s("el-tabs",{attrs:{type:"card","tab-position":"top"}},[s("el-tab-pane",[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-document"}),e._v(e._s(e.xlsx1.title))]),s("br"),s("br"),s("el-collapse",[e.xlsx1.info?s("el-collapse-item",[s("template",{slot:"title"},[s("el-badge",{attrs:{value:e.xlsx1.info.length,"is-dot":!1,hidden:!1,type:"success"}},[s("el-link",{attrs:{type:"success",underline:!1}},[e._v("Registros Recuperados")])],1)],1),s("ArrayPaginate",{attrs:{list:e.xlsx1.info,filterable:""},scopedSlots:e._u([{key:"default",fn:function(e){return[s("ShowObject",{attrs:{object:e.item,type:"success","show-all":"","show-area-info":""}})]}}],null,!1,528621187)})],2):e._e()],1),s("LoadCoopPlanillas",{on:{"on-filter":e.onFilterD1}})],1),s("el-tab-pane",[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-document"}),e._v(e._s(e.xlsx2.title))]),s("FilterExcelColumns",{attrs:{"default-columns":e.xlsx2.filterColumns,"default-no-null-columns":e.xlsx2.noNullColumns,"defaultfirst-row":e.xlsx2.firstRow,"default-unique-columns":e.xlsx2.uniqueColumns},on:{"on-filter":e.onFilterD2}})],1),s("el-tab-pane",[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-document"}),e._v("Emparejacion de datos")]),e.xlsx1.info&&e.xlsx2.info?s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:22,offset:0}},[s("match-info",{attrs:{arr1:e.xlsx1.info,arr2:e.xlsx2.info},on:{"on-match":e.onGenerateMatchList}})],1)],1):e._e()],1),s("el-tab-pane",[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-document"}),e._v("Comparacion de datos")]),s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:22,offset:0}},[s("ValidateData",{attrs:{"match-list":e.matchList}})],1)],1)],1)],1)],1)},w=[],C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.object?s("div",{staticClass:"container",attrs:{type:e.type,shadow:"hover"}},[s("el-popover",{attrs:{placement:"bottom",disabled:!e.showPupover,title:e.title?e.title:e.generateTitle,trigger:"hover"}},[s("el-alert",{attrs:{type:e.type,effect:"light","show-icon":"",closable:!1}},[s("table",{attrs:{border:"0px"}},e._l(Object.keys(e.object),(function(t){return s("tr",{key:t},[s("td",{attrs:{align:"right"}},[s("strong",[e._v(e._s(t))])]),s("td",[e._v(e._s(e.object[t]))])])})),0)]),s("el-link",{attrs:{slot:"reference",type:"error"===e.type?"danger":e.type,underline:!0},on:{click:e.toggleShow},slot:"reference"},[e._v(" "+e._s(e.title?e.title:e.generateTitle)+" ")])],1),e.showAllContent?[s("el-alert",{attrs:{type:e.type,effect:"light","show-icon":"",closable:!1}},[s("table",{attrs:{border:"0px"}},[e._l(Object.keys(e.object),(function(t){return[e.hideKeys.includes(t)?e._e():s("tr",{key:t},[s("td",{attrs:{align:"right"}},[s("Strong",[e._v(e._s(t))])],1),s("td",{attrs:{align:"center"}},[e._v(" - ")]),s("td",{attrs:{align:"left"}},[e._v(" "+e._s(e.object[t])+" ")])])]}))],2)])]:e._e()],2):e._e()},L=[],k=(s("a15b"),s("d81d"),s("b64b"),{name:"ShowObject",props:{showAll:{type:Boolean,default:!1},title:{type:String,default:null},object:{type:Object,default:function(){return null}},principalKeys:{type:Array,default:function(){return null}},showAreaInfo:{type:Boolean,default:function(){return!1}},type:{type:String,default:"info"},showPupover:{type:Boolean,default:!1},hideKeys:{type:Array,default:function(){return[]}}},data:function(){return{showAllContent:!1}},computed:{generateTitle:function(){var e=this;return this.getPrincipalKeys().map((function(t){return"undefined"===String(e.object[t])?"no tiene":e.object[t]})).join(" ")}},methods:{getPrincipalKeys:function(){return this.principalKeys&&this.object?this.principalKeys:this.showAll?Object.keys(this.object):[Object.keys(this.object)[0]]},toggleShow:function(){this.showAreaInfo&&(this.showAllContent=!this.showAllContent)}}}),K=k,x=(s("a17f"),Object(p["a"])(K,C,L,!1,null,"6ce70539",null)),_=x.exports,j=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[e.filterable?s("div",{staticClass:"filter-container"},[s("el-row",{attrs:{gutter:20,type:"flex",justify:"end"}},[s("el-input",{staticClass:"filter-component",attrs:{placeholder:"palabra a buscar",size:"small",clearable:""},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),s("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.filterList}},[e._v("Buscar")])],1)],1):e._e(),s("div",{staticClass:"data-container"},[s("el-row",{attrs:{gutter:20}},[e.getIndexs().length>0?e._l(e.getIndexs(),(function(t){return s("el-col",{key:t,attrs:{span:24}},[s("el-container",{staticClass:"row-container",attrs:{direction:"horizontal"}},[s("span",{staticClass:"index"},[s("strong",[e._v(e._s(t+1+".- "))])]),e.onSelect?s("el-tooltip",{attrs:{content:"Seleccionar",placement:"top",effect:"dark"}},[s("el-link",{staticClass:"icon-select",attrs:{underline:!1},on:{click:function(s){return e.onSelect(Object.assign({},e.filteredList[t]))}}},[s("i",{staticClass:"el-icon-s-flag"})])],1):e._e(),s("div",{staticClass:"slot-container"},[e._t("default",null,{index:e.list.indexOf(e.filteredList[t]),item:Object.assign({},e.filteredList[t])})],2)],1)],1)})):[e._v(" Sin Datos ")]],2)],1),s("el-pagination",{attrs:{small:"","current-page":e.currentPage,"page-sizes":[5,10,20,40,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.filteredList.length,"hide-on-single-page":"",background:""},on:{"size-change":e.sizeChange,"current-change":e.currentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}},[e._v(' :pager-count="7"> ')])],1)},O=[],E=(s("4de4"),s("caad"),s("2532"),{name:"ArrayPaginate",props:{list:{type:Array,default:function(){return[]}},filterMethod:{type:Function,default:null},filterable:{type:Boolean,default:!1},onSelect:{type:Function,default:null}},data:function(){return{currentPage:1,pageSize:10,keyword:"",filteredList:[]}},computed:{},watch:{list:function(){this.filterList()}},created:function(){this.filteredList=this.list},methods:{filterList:function(){var e=this;this.currentPage=1,this.filteredList=this.list.filter((function(t){return e.filterMethod?e.filterMethod(t,e.keyword):JSON.stringify(t).toUpperCase().includes(String(e.keyword).toUpperCase())}))},sizeChange:function(e){this.pageSize=e,this.currentPage=1},currentChange:function(e){this.currentPage=e},getIndexs:function(){for(var e=[],t=(this.currentPage-1)*this.pageSize;t<this.currentPage*this.pageSize;t++){if(void 0==this.filteredList[t])break;e.push(t)}return e}}}),A=E,S=(s("ac68"),Object(p["a"])(A,j,O,!1,null,"d21fcb28",null)),N=S.exports,R=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-collapse",{attrs:{accordion:!0}},[s("el-collapse-item",{attrs:{title:e.dp.desc}},[s("FilterExcelColumns",{attrs:{"default-columns":e.dp.fc,"default-no-null-columns":e.dp.noNC,"defaultfirst-row":e.dp.firstRow,"default-unique-columns":["Nro. SOCIO"]},on:{"on-filter":e.onFilterDP}})],1),s("el-collapse-item",{attrs:{title:e.np.desc}},[s("FilterExcelColumns",{attrs:{"default-columns":e.np.fc,"default-no-null-columns":e.np.noNC,"defaultfirst-row":e.np.firstRow,"default-unique-columns":["Nro. SOCIO"]},on:{"on-filter":e.onFilterNP}})],1),s("el-collapse-item",{attrs:{title:e.j.desc}},[s("FilterExcelColumns",{attrs:{"default-columns":e.j.fc,"default-no-null-columns":e.j.noNC,"defaultfirst-row":e.j.firstRow,"default-unique-columns":["Nro. SOCIO"]},on:{"on-filter":e.onFilterJ}})],1),s("el-collapse-item",{attrs:{title:e.g.desc}},[s("FilterExcelColumns",{attrs:{"default-columns":e.g.fc,"default-no-null-columns":e.g.noNC,"defaultfirst-row":e.g.firstRow,"default-unique-columns":["Nro. SOCIO"]},on:{"on-filter":e.onFilterG}})],1)],1)},D=[],T=(s("99af"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:24,lg:{span:this.jsonData?7:24,offset:0},offset:0}},[s("el-row",{attrs:{gutter:20,type:"flex",justify:"center"}},[s("UploadExcel",{attrs:{"on-read":e.onRead,"filter-columns":e.fcook,"no-null-columns":e.noNullColumns,"first-row":e.firstRow},on:{"on-filter":e.onFilter}})],1)],1),s("el-col",{directives:[{name:"show",rawName:"v-show",value:e.jsonData,expression:"jsonData"}],attrs:{span:24,lg:{span:16,offset:0},offset:0}},[s("el-collapse",{attrs:{accordion:!0}},[s("el-collapse-item",[s("template",{slot:"title"},[s("el-link",{attrs:{type:"primary",underline:!1}},[e._v("Filtros")])],1),s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:15,offset:0}},[s("DndList",{attrs:{list1:e.filterColumns,list2:e.filterColumnsList,list1Title:"Columnas a Filtrar",list2Title:"Columnas Encontradas"},on:{"on-change-list1":e.onChangeFilterColumns}})],1),s("el-col",{attrs:{span:7,offset:0}},[s("h4",[s("span",[e._v("Seleccione las columnas que deben tener contenido para ser tomados como un registro valido")])]),s("el-select",{attrs:{placeholder:"Seleccione las columnas que no pueden ser nulas.",multiple:"",filterable:"",clearable:""},model:{value:e.noNullColumns,callback:function(t){e.noNullColumns=t},expression:"noNullColumns"}},e._l(e.filterColumns,(function(e){return s("el-option",{key:e.oldKey,attrs:{label:e.newKey,value:e.oldKey}})})),1),s("h4",[s("span",[e._v("Numero de fila del primer registro")])]),s("el-input",{attrs:{placeholder:"numero de fila del primer registro valido",size:"normal",clearable:""},model:{value:e.firstRow,callback:function(t){e.firstRow=t},expression:"firstRow"}}),s("h4",[s("span",[e._v("Buscar Registros Repetidos por Columna")])]),s("el-select",{attrs:{placeholder:"Seleccione las columnas que no deben repetirse.",multiple:"",filterable:"",clearable:""},on:{change:e.searchRepeatRegisters},model:{value:e.uniqueColumns,callback:function(t){e.uniqueColumns=t},expression:"uniqueColumns"}},e._l(e.filterColumns,(function(e){return s("el-option",{key:e.oldKey,attrs:{label:e.newKey,value:e.oldKey}})})),1)],1)],1)],2),e.info?s("el-collapse-item",[s("template",{slot:"title"},[s("el-badge",{attrs:{value:e.info.length,"is-dot":!1,hidden:!1,type:"success"}},[s("el-link",{attrs:{type:"success",underline:!1}},[e._v("Registros Recuperados")])],1)],1),s("ArrayPaginate",{attrs:{list:e.info,filterable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("showobject",{attrs:{object:t.item,type:"success","show-all":"","show-area-info":""}}),s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",round:""},on:{click:function(s){return e.onDeleted(t.index,t.item)}}},[e._v("Eliminar de Lista")])]}}],null,!1,3706064044)})],2):e._e(),e.excluded?s("el-collapse-item",{attrs:{title:"Registros Desechados"}},[s("template",{slot:"title"},[s("el-badge",{attrs:{value:e.excluded.length,"is-dot":!1,hidden:!1,type:"warning"}},[s("el-link",{attrs:{type:"warning",underline:!1}},[e._v("Registros Descartados")])],1)],1),s("ArrayPaginate",{attrs:{list:e.excluded,filterable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("showobject",{attrs:{object:t.item,"show-all":"",type:"warning","show-area-info":""}}),s("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-check",round:""},on:{click:function(s){return e.onAdded(t.index,t.item)}}},[e._v("Añadir a Lista")])]}}],null,!1,2394673320)})],2):e._e(),e.repeatList.length>0?s("el-collapse-item",{attrs:{title:"Registros Repetidos"}},[s("template",{slot:"title"},[s("el-badge",{attrs:{value:e.repeatList.length,"is-dot":!1,hidden:!1,type:"danger"}},[s("el-link",{attrs:{type:"danger",underline:!1}},[e._v("Registros Repetidos")])],1)],1),s("ArrayPaginate",{attrs:{list:e.repeatList,filterable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12,offset:0}},[s("showobject",{attrs:{object:t.item.e1,"principal-keys":e.uniqueColumns,type:"error","show-area-info":""}}),s("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-check",round:""},on:{click:function(s){return e.onRepeatUse(t.item,1)}}},[e._v("Usar Este")])],1),s("el-col",{attrs:{span:12,offset:0}},[s("showobject",{attrs:{object:t.item.e2,"principal-keys":e.uniqueColumns,type:"error","show-area-info":""}}),s("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-check",round:""},on:{click:function(s){return e.onRepeatUse(t.item,2)}}},[e._v("Usar Este")])],1)],1)]}}],null,!1,953891611)})],2):e._e()],1)],1)],1)],1)}),I=[],P=(s("4160"),s("13d5"),s("a9e3"),s("159b"),s("2909")),M=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:11,offset:0}},[s("h3",[e._v(e._s(e.list1Title))]),s("draggable",{staticClass:"dragArea",attrs:{list:e.dlist1,group:"article"}},e._l(e.dlist1,(function(t){return s("div",{key:t.oldKey,staticClass:"list-complete-item"},[s("div",{staticClass:"list-complete-item-handle"},[t.oldKey===e.editEleOldKey?s("el-input",{attrs:{placeholder:"intro nuevo nombre",size:"mini"},model:{value:e.editEleNewKey,callback:function(t){e.editEleNewKey=t},expression:"editEleNewKey"}}):[e._v(e._s(t.oldKey)+" | "+e._s(t.newKey))]],2),s("div",{staticStyle:{position:"absolute",right:"0px"}},[s("span",{staticStyle:{float:"right","margin-top":"-20px","margin-right":"5px"},on:{click:function(s){return e.deleteEle(t)}}},[s("i",{staticClass:"el-icon-delete",staticStyle:{color:"#F56C6C"}})]),t.oldKey===e.editEleOldKey?s("span",{staticStyle:{float:"right","margin-top":"-20px","margin-right":"5px"},on:{click:function(s){return e.saveEle(t)}}},[s("i",{staticClass:"el-icon-check",staticStyle:{color:"#67C23A"}})]):s("span",{staticStyle:{float:"right","margin-top":"-20px","margin-right":"5px"},on:{click:function(s){return e.editEle(t)}}},[s("i",{staticClass:"el-icon-edit",staticStyle:{color:"#E6A23C"}})])])])})),0)],1),s("el-col",{attrs:{span:11,offset:0}},[s("h3",[e._v(e._s(e.list2Title))]),s("draggable",{staticClass:"dragArea",attrs:{list:e.dlist2,group:"article"}},e._l(e.dlist2,(function(t){return s("div",{key:t.oldkey,staticClass:"list-complete-item"},[s("div",{staticClass:"list-complete-item-handle2",on:{click:function(s){return e.pushEle(t)}}},[e._v(" "+e._s(t.oldKey)+" | "+e._s(t.newKey)+" ")])])})),0)],1)],1)},F=[],B=(s("a623"),s("c975"),s("a434"),s("b85c")),$=s("b76a"),z=s.n($),U={name:"DndList",components:{draggable:z.a},props:{list1:{type:Array,default:function(){return[]}},list2:{type:Array,default:function(){return[]}},list1Title:{type:String,default:"list1"},list2Title:{type:String,default:"list2"}},data:function(){return{dlist1:[],dlist2:[],editEleOldKey:null,editEleNewKey:null}},watch:{list1:function(e){this.dlist1=e},list2:function(e){var t=this;this.dlist2=e.filter((function(e){return!t.dlist1.includes(e)}))},dlist1:function(e){this.$emit("on-change-list1",e)},dlist2:function(e){this.$emit("on-change-list2",e)}},created:function(){var e=this;this.dlist1=this.list1,this.dlist2=this.list2.filter((function(t){return!e.dlist1.includes(t)}))},methods:{isNotInList1:function(e){return this.list1.every((function(t){return e.oldKey!==t.oldKey}))},isNotInList2:function(e){return this.list2.every((function(t){return e.oldKey!==t.oldKey}))},editEle:function(e){this.editEleOldKey=e.oldKey,this.editEleNewKey=e.newKey},saveEle:function(e){if(this.editEleNewKey.length<1)this.$message({message:"No puede dejar este campo vacio.",type:"warning",showClose:!0,duration:5e3});else{var t,s=Object(B["a"])(this.list1);try{for(s.s();!(t=s.n()).done;){var n=t.value;if(n.oldKey===e.oldKey){var l=this.list1.indexOf(n);this.list1[l].newKey=this.editEleNewKey;break}}}catch(i){s.e(i)}finally{s.f()}this.editEleOldKey=null,this.editEleNewKey=null}},deleteEle:function(e){var t,s=Object(B["a"])(this.list1);try{for(s.s();!(t=s.n()).done;){var n=t.value;if(n.oldKey===e.oldKey){var l=this.list1.indexOf(n);this.list1.splice(l,1);break}}}catch(i){s.e(i)}finally{s.f()}this.isNotInList2(e)&&this.list2.unshift(e)},pushEle:function(e){var t,s=Object(B["a"])(this.list2);try{for(s.s();!(t=s.n()).done;){var n=t.value;if(n.oldKey===e.oldKey){var l=this.list2.indexOf(n);this.list2.splice(l,1);break}}}catch(i){s.e(i)}finally{s.f()}this.isNotInList1(e)&&this.list1.push(e)}}},G=U,J=(s("3d08"),Object(p["a"])(G,M,F,!1,null,"7e1c99d5",null)),q=J.exports,V=s("5530");function W(e,t){var s={};return t.forEach((function(t){s[t.newKey]=e[t.oldKey]})),s}function H(e,t){var s={};return Object.keys(e).forEach((function(n){t.includes(n)?s=Object(V["a"])(Object(V["a"])({},s),e[n]):s[n]=e[n]})),s}var Y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-upload",{attrs:{action:"/",drag:"","on-remove":e.onRemoveFile,"on-change":e.beforeUpload,"on-exceed":e.onExceeded,"auto-upload":!1,limit:1,"list-type":"picture"}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[e._v(" Suelta tu archivo aquí o "),s("em",[e._v("haz clic para cargar")])]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" Archivos xlsx ")])])],1)},Z=[],Q=(s("d3b7"),s("5cc6"),s("9a8c"),s("a975"),s("735e"),s("c1ac"),s("d139"),s("3a7b"),s("d5d6"),s("82f8"),s("e91f"),s("60bd"),s("5f96"),s("3280"),s("3fcc"),s("ca91"),s("25a1"),s("cd26"),s("3c5d"),s("2954"),s("649e"),s("219c"),s("170b"),s("b39a"),s("72f7"),s("1146")),X=s.n(Q);s("ac1f"),s("5319"),s("1276");function ee(e){for(var t=0,s=0,n=e.length;t<n;t++)s=26*s+e.charCodeAt(t)-64;return s-1}function te(e){for(var t="";e>=0;e=parseInt(e/26,10)-1)t=String.fromCharCode(e%26+65)+t;return t}function se(e){var t,s=[],n=e.split(":").map((function(e){return ee(e.replace(/[0-9]/g,""))})),l=n[0],i=n[1]+1;for(t=l;t<i;t++)s.push(te(t));return s}var ne=se,le={name:"UploadExcel",props:{filterColumns:{type:Array,default:function(){return[]}},noNullColumns:{type:Array,default:function(){return[]}},firstRow:{type:Number,default:1},endRow:{type:Number,default:null},onRead:{type:Function,default:null}},data:function(){return{file:{},masterJson:null,info:null,finalLineIndex:null,excluded:null}},watch:{filterColumns:function(e){e&&this.getInfo()},noNullColumns:function(e){e&&this.getInfo()},file:function(e){e?this.excelToJson(e):this.deleteData()}},methods:{inRange:function(e){return e.__rowNum__>=this.firstRow-1&&(!this.endRow||this.endRow>=e.__rowNum__)},NoNullColums:function(){return this.noNullColumns?this.noNullColumns:this.filterColumns},excelToJson:function(e){var t=this,s=e.raw,n=new FileReader;n.onload=function(e){var s=new Uint8Array(e.target.result),n=X.a.read(s,{type:"array"}),l=n.SheetNames[0];t.$emit("on-read-worbook",n);var i=n.Sheets[l],o=ne("A:AZ");t.masterJson=X.a.utils.sheet_to_json(i,{header:o}),t.onRead&&t.onRead(Object(P["a"])(t.masterJson)),t.getInfo()},n.readAsArrayBuffer(s)},getInfo:function(){var e=this;null!==this.masterJson&&(this.excluded=[],this.info=this.masterJson.map((function(t){if(e.inRange(t)){var s=e.filterRowWithNoNullColumns(t);return!!s&&Object(V["a"])({},s)}return!1})).filter((function(e){return e})),this.$emit("on-filter",{data:Object(P["a"])(this.info),excluded:Object(P["a"])(this.excluded)}))},filterRowWithNoNullColumns:function(e){var t=this;if(0===this.filterColumns.length)return!0;var s={},n=this.filterColumns.filter((function(n){return s[n]=e[n],!!t.NoNullColums().includes(n)&&void 0!==e[n]}));return n.length===this.NoNullColums().length?s:(this.excluded.push(s),!1)},onRemoveFile:function(){this.file=null,this.masterJson=null,this.info=null,this.onRead&&this.onRead(null),this.$emit("on-filter",{data:null,excluded:null})},beforeUpload:function(e){this.file=e},onExceeded:function(){this.$message({message:"Ya se selecciono un Archivo, eliminelo para subir otro",type:"warning",showClose:!0,duration:3e3})},deleteData:function(){this.file=null,this.dataKeys=null,this.info=null,this.masterJson=null,this.excluded=null,this.$emit("on-filter",{data:null,excluded:null})},getInjectColumnSheet:function(e){return{v:e,t:"s",w:e}}}},ie=le,oe=Object(p["a"])(ie,Y,Z,!1,null,null,null),ae=oe.exports,re={name:"FilterExcelColumns",components:{UploadExcel:ae,DndList:q,ArrayPaginate:N,showobject:_},props:{defaultColumns:{type:Array,default:function(){return[]}},defaultNoNullColumns:{type:Array,default:function(){return[]}},defaultfirstRow:{type:Number,default:1},defaultUniqueColumns:{type:Array,default:null}},data:function(){return{fcook:[],filterColumns:[],firstRow:1,filterColumnsList:[],noNullColumns:[],jsonData:null,info:null,excluded:null,uniqueColumns:null,repeatList:[]}},watch:{filterColumns:function(){this.fcook=this.filterColumns.map((function(e){return e.oldKey}))}},created:function(){this.filterColumns=Object(P["a"])(this.defaultColumns),this.noNullColumns=Object(P["a"])(this.defaultNoNullColumns),this.filterColumnsList=Object(P["a"])(this.defaultColumns),this.fcook=this.filterColumns.map((function(e){return e.oldKey})),this.firstRow=this.defaultfirstRow,this.uniqueColumns=this.defaultUniqueColumns},methods:{getFilterColumns:function(){var e=[];this.jsonData.forEach((function(t){Object.keys(t).forEach((function(t){e.includes(t)||e.push(t)}))}));var t=this.filterColumnsList.map((function(e){return e.oldKey}));this.filterColumnsList=this.filterColumnsList.concat(e.map((function(e){return!t.includes(e)&&{oldKey:e,newKey:e}})).filter((function(e){return e})))},onRead:function(e){this.jsonData=e,this.jsonData&&this.getFilterColumns()},onFilter:function(e){var t=this,s=e.data,n=e.excluded;s&&n?(this.info=s.map((function(e){return W(e,Object(P["a"])(t.filterColumns))})),this.excluded=n.map((function(e){return W(e,t.filterColumns)})),this.searchRepeatRegisters()):(this.info=null,this.excluded=null,this.repeatList=[]),this.emitChanges()},onAdded:function(e,t){this.excluded=this.excluded.filter((function(t,s){return s!==e})),this.info.push(t),this.emitChanges()},onDeleted:function(e,t){this.info=this.info.filter((function(t,s){return s!==e})),this.excluded.push(t),this.emitChanges()},onChangeFilterColumns:function(e){this.filterColumns=e},onChangeFilterColumnsList:function(e){this.filterColumnsList=e},searchRepeatRegisters:function(){var e=this;if(this.uniqueColumns){var t=[],s=[];this.info.forEach((function(n,l){e.info.forEach((function(i,o){l!==o&&e.uniqueColumns.reduce((function(e,t){return e|n[t]===i[t]}),!1)&&!s.includes(l)&&(t.push({i1:l,e1:n,i2:o,e2:i}),s.push(l),s.push(o))}))})),this.repeatList=t}},onRepeatUse:function(e,t){1===t?this.onDeleted(e.i2,e.e2):2===t&&this.onDeleted(e.i1,e.e1)},emitChanges:function(){this.searchRepeatRegisters(),this.$emit("change",this.info),this.$emit("on-filter",this.info)}}},ce=re,ue=(s("97af"),Object(p["a"])(ce,T,I,!1,null,"6ea926e9",null)),fe=ue.exports,de={name:"LoadCoopPlanillas",components:{FilterExcelColumns:fe},data:function(){return{dp:{desc:"PLANILLA DESCUENTOS",fc:[{oldKey:"B",newKey:"Nro. SOCIO"},{oldKey:"C",newKey:"CEDULA DE IDENTIDAD"},{oldKey:"D",newKey:"APELLIDO PATERNO"},{oldKey:"E",newKey:"APELLIDO MATERNO"},{oldKey:"F",newKey:"NOMBRES"},{oldKey:"AF",newKey:"TOTAL GENERAL"}],noNC:["F","AF"],firstRow:10,info:[]},j:{desc:"PLANILLA JORNALEROS",fc:[{oldKey:"B",newKey:"Nro. SOCIO"},{oldKey:"C",newKey:"CEDULA DE IDENTIDAD"},{oldKey:"D",newKey:"APELLIDO PATERNO"},{oldKey:"E",newKey:"APELLIDO MATERNO"},{oldKey:"F",newKey:"NOMBRES"},{oldKey:"O",newKey:"TOTAL GENERAL"}],firstRow:12,noNC:["F","O"],info:[]},np:{desc:"PLANILLA NO PERMANENTES",fc:[{oldKey:"B",newKey:"Nro. SOCIO"},{oldKey:"C",newKey:"CEDULA DE IDENTIDAD"},{oldKey:"D",newKey:"APELLIDO PATERNO"},{oldKey:"E",newKey:"APELLIDO MATERNO"},{oldKey:"F",newKey:"NOMBRES"},{oldKey:"U",newKey:"TOTAL GENERAL"}],firstRow:8,noNC:["F","U"],info:[]},g:{desc:"PLANILLA GRANJAS",fc:[{oldKey:"B",newKey:"Nro. SOCIO"},{oldKey:"C",newKey:"CEDULA DE IDENTIDAD"},{oldKey:"D",newKey:"APELLIDO PATERNO"},{oldKey:"E",newKey:"APELLIDO MATERNO"},{oldKey:"F",newKey:"NOMBRES"},{oldKey:"N",newKey:"TOTAL GENERAL"}],firstRow:12,noNC:["F","N"],info:[]}}},methods:{onFilterDP:function(e){this.dp.info=e,this.change()},onFilterG:function(e){this.g.info=e,this.change()},onFilterNP:function(e){this.np.info=e,this.change()},onFilterJ:function(e){this.j.info=e,this.change()},change:function(){var e=[];this.dp.info&&(e=e.concat(this.dp.info)),this.np.info&&(e=e.concat(this.np.info)),this.j.info&&(e=e.concat(this.j.info)),this.g.info&&(e=e.concat(this.g.info)),this.$emit("on-filter",e)}}},he=de,pe=Object(p["a"])(he,R,D,!1,null,null,null),me=pe.exports,ye=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.arr1.length>0&&e.arr2.length>0?s("div",[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:7,offset:0}},[s("h3",[s("span",[e._v("Seleccione Campo de la Lista 1")])]),s("el-select",{attrs:{placeholder:"seleccione campo a comparar",multiple:"",clearable:""},model:{value:e.l1CompareKeys,callback:function(t){e.l1CompareKeys=t},expression:"l1CompareKeys"}},e._l(e.getKeysList(e.list1),(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),s("el-col",{attrs:{span:7,offset:0}},[s("h3",[s("span",[e._v("Criterio de Comparación")])]),s("el-select",{attrs:{placeholder:"seleccione 1"},model:{value:e.algoSelect,callback:function(t){e.algoSelect=t},expression:"algoSelect"}},e._l(e.arrAlgoComp,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),s("br"),s("br"),s("el-button",{attrs:{disabled:e.showResults,type:"primary",size:"default"},on:{click:e.matching}},[e._v("Iniciar Agrupacion")]),e._v(" "),s("br"),s("el-button",{attrs:{type:"danger",size:"default"},on:{click:e.initComponents}},[e._v("Reiniciar")])],1),s("el-col",{attrs:{span:7,offset:0}},[s("h3",[s("span",[e._v("Seleccione Campo de la Lista 2")])]),s("el-select",{attrs:{placeholder:"seleccione campo a comparar",multiple:"",clearable:""},model:{value:e.l2CompareKeys,callback:function(t){e.l2CompareKeys=t},expression:"l2CompareKeys"}},e._l(e.getKeysList(e.list2),(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),s("br"),e.showResults?s("el-collapse",{attrs:{accordion:!0}},[s("el-collapse-item",[s("span",{attrs:{slot:"title"},slot:"title"},[s("el-badge",{attrs:{value:e.matchList.length,hidden:!1,type:"success"}},[s("el-link",{attrs:{type:"success",underline:!1}},[e._v("Registros Emparejados")])],1)],1),s("array-paginate",{attrs:{list:e.matchList,filterable:""},scopedSlots:e._u([{key:"default",fn:function(t){return s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:10,offset:0}},[s("show-object",{attrs:{object:t.item.d1,"principal-keys":e.l1CompareKeys,type:"success","show-area-info":""}})],1),s("el-col",{attrs:{span:10,offset:0}},[s("show-object",{attrs:{object:t.item.d2,"principal-keys":e.l2CompareKeys,type:"success","show-area-info":""}})],1)],1)}}],null,!1,3672854)}),s("GenerateAdvancedReport",{attrs:{list:e.matchList,"extract-sub-objects":["d1","d2"]}}),s("InyectToExcel",{attrs:{list:e.genMLjoinObj,"first-row":4,ik:"ITEM",tk:"TOTAL GENERAL",ic:"E",tc:"L"}})],1),e.possibleMatchList.length>0?s("el-collapse-item",[s("span",{attrs:{slot:"title"},slot:"title"},[s("el-badge",{attrs:{value:e.possibleMatchList.length,hidden:!1,type:"primary"}},[s("el-link",{attrs:{type:"info",underline:!1}},[e._v("Registros por confirmar")])],1)],1),e._v(" Lista por Confirmar "),s("possible-match-list",{attrs:{list:e.possibleMatchList},on:{"on-confirm":e.PMLonConfirm,"on-delete":e.PMLonDelete}})],1):e._e(),e.list1.length>0||e.list2.length>0?s("el-collapse-item",[s("span",{attrs:{slot:"title"},slot:"title"},[s("el-badge",{attrs:{value:Math.max(e.list1.length,e.list2.length),max:99,hidden:!1}},[s("el-link",{attrs:{type:"danger",underline:!1}},[e._v("Registros no Emparejados")])],1)],1),e._v(" Listas No emparejadas "),s("no-matched-lists",{attrs:{list1:e.list1,list2:e.list2},on:{"on-matched":e.onMatchNM}})],1):e._e()],1):e._e()],1):e._e()},ge=[],be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-button",{attrs:{type:"primary",size:"default"},on:{click:e.onShowDialog}},[e._v("Generar Excel")]),s("el-dialog",{attrs:{title:"Generar Excel Personalizado",visible:e.showDialog,width:"70%"},on:{"update:visible":function(t){e.showDialog=t}}},[s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:23,offset:0}},[s("DndList",{attrs:{list1:e.orderListKeys,list2:e.newListKeys,list1Title:"Columnas para Exportar",list2Title:"Columnas Posibles"},on:{"on-change-list1":e.onChangeOrderListKeys}})],1)],1),s("br"),s("el-form",{attrs:{"label-width":"95px",inline:!0}},[s("el-form-item",{attrs:{label:"Ordenar Por:"}},[s("el-select",{staticClass:"select",attrs:{placeholder:"Seleccione una columna",clearable:""},model:{value:e.orderBy,callback:function(t){e.orderBy=t},expression:"orderBy"}},e._l(e.orderListKeys,(function(e){return s("el-option",{key:e.oldKey,attrs:{label:e.newKey,value:e.newKey}})})),1),e._v(" "+e._s(" | ")+" "),s("el-switch",{attrs:{"active-text":"Ascendente","inactive-text":"Descendente","active-color":"#13ce66","inactive-color":"#ff4949","active-value":!0,"inactive-value":!1},model:{value:e.orderByAscend,callback:function(t){e.orderByAscend=t},expression:"orderByAscend"}})],1)],1),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("Cancelar")]),s("el-button",{attrs:{type:"primary"},on:{click:e.OnGenerate}},[e._v("Generar")])],1)],1)],1)},ve=[];s("c19f"),s("25f0");function we(e,t){t&&(e+=1462);var s=Date.parse(e);return(s-new Date(Date.UTC(1899,11,30)))/864e5}function Ce(e,t){for(var s={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},l=0;l!=e.length;++l)for(var i=0;i!=e[l].length;++i){n.s.r>l&&(n.s.r=l),n.s.c>i&&(n.s.c=i),n.e.r<l&&(n.e.r=l),n.e.c<i&&(n.e.c=i);var o={v:e[l][i]};if(null!=o.v){var a=X.a.utils.encode_cell({c:i,r:l});"number"===typeof o.v?o.t="n":"boolean"===typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=X.a.SSF._table[14],o.v=we(o.v)):o.t="s",s[a]=o}}return n.s.c<1e7&&(s["!ref"]=X.a.utils.encode_range(n)),s}function Le(){if(!(this instanceof Le))return new Le;this.SheetNames=[],this.Sheets={}}function ke(e){for(var t=new ArrayBuffer(e.length),s=new Uint8Array(t),n=0;n!=e.length;++n)s[n]=255&e.charCodeAt(n);return t}function Ke(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.multiHeader,s=void 0===t?[]:t,n=e.header,l=e.data,i=e.filename,o=e.merges,a=void 0===o?[]:o,r=e.autoWidth,c=void 0===r||r,u=e.bookType,f=void 0===u?"xlsx":u;i=i||"excel-list",l=Object(P["a"])(l),l.unshift(n);for(var d=s.length-1;d>-1;d--)l.unshift(s[d]);var h="SheetJS",p=new Le,m=Ce(l);if(a.length>0&&(m["!merges"]||(m["!merges"]=[]),a.forEach((function(e){m["!merges"].push(X.a.utils.decode_range(e))}))),c){for(var y=l.map((function(e){return e.map((function(e){return null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}}))})),g=y[0],b=1;b<y.length;b++)for(var v=0;v<y[b].length;v++)g[v]["wch"]<y[b][v]["wch"]&&(g[v]["wch"]=y[b][v]["wch"]);m["!cols"]=g}p.SheetNames.push(h),p.Sheets[h]=m;var w=X.a.write(p,{bookType:f,bookSST:!1,type:"binary"});saveAs(new Blob([ke(w)],{type:"application/octet-stream"}),"".concat(i,".").concat(f))}s("0fd4");var xe={name:"GenerateAdvancedReport",props:{list:{type:Array,default:function(){return[]}},extractSubObjects:{type:Array,default:null},fileName:{type:String,default:null}},components:{DndList:q},data:function(){return{showDialog:!1,newJsonList:[],basicList:[],newListKeys:[],orderListKeys:[],orderBy:null,orderByAscend:!0}},methods:{getNewListKeys:function(){return this.basicList.length>0?Object.keys(this.basicList[0]).map((function(e){return{oldKey:e,newKey:e}})):[]},getBasicList:function(){var e=this;return this.extractSubObjects?this.list.map((function(t){return H(t,e.extractSubObjects)})):this.list},generateNewList:function(){var e=this;this.newJsonList=this.basicList.map((function(t){return W(t,e.orderListKeys)}))},compare:function(e,t){return e[this.orderBy]<t[this.orderBy]?this.orderByAscend?-1:1:e[this.orderBy]>t[this.orderBy]?this.orderByAscend?1:-1:0},OnGenerate:function(){if(this.generateNewList(),this.newJsonList.sort(this.compare),this.newJsonList.length>0){var e=Object.keys(this.newJsonList[0]),t=this.newJsonList.map((function(e){return Object.keys(e).map((function(t){return e[t]}))}));Ke({header:e,data:t,filename:this.fileName}),this.showDialog=!1,this.$message({message:"Archivo Guardado Exitosamente!!!",type:"success",showClose:!0,duration:5e3})}else this.$message({message:"La lista a exportar esta vacia!!!",type:"info",showClose:!0,duration:5e3})},onShowDialog:function(){this.showDialog=!0,this.basicList=this.getBasicList(),this.newListKeys=this.getNewListKeys()},onChangeOrderListKeys:function(e){this.orderListKeys=e}}},_e=xe,je=Object(p["a"])(_e,be,ve,!1,null,"e8589754",null),Oe=je.exports,Ee=(s("fb6a"),function(e,t){var s=Ae(String(e).toUpperCase().split("-").join("").split(" ").join("")),n=Ae(String(t).toUpperCase().split("-").join("").split(" ").join(""));return s.ci===n.ci?s.complemento||n.complemento?s.complemento===n.complemento?1:0:1:-1}),Ae=function(e){var t=null,s=e.slice(-2);Se.includes(s)&&(t=s,e=e.slice(0,-2));var n=null;return String(parseInt(e)).length!==e.length&&(n=e.slice(-2),e=e.slice(0,-2)),e=parseInt(e)+"",{ABR:t,complemento:n,ci:e}},Se=["SC","TJ","OR","LP","CB","BE","PD","PT","CH","PO"],Ne=function(e,t){var s=e.map((function(e){return e?e.toUpperCase():""})).join("").split("").join(),n=t.map((function(e){return e?e.toUpperCase():""})).join("").split("").join();return s===n},Re=function(e,t){return parseFloat(e)===parseFloat(t)},De={compareCI:Ee,compareNames:Ne,compareNumbers:Re},Te=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:11,offset:0}},[e._v(" Lista Documento 1 "),s("el-select",{attrs:{placeholder:"seleccione las columnas",clearable:"",multiple:""},model:{value:e.showKeysList1,callback:function(t){e.showKeysList1=t},expression:"showKeysList1"}},e._l(e.list1.length>0?Object.keys(e.list1[0]):[],(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1),s("br"),s("array-paginate",{attrs:{list:e.list1,filterable:"","on-select":e.onSelectl1},scopedSlots:e._u([{key:"default",fn:function(t){return s("show-object",{attrs:{object:t.item,"principal-keys":e.showKeysList1,type:"error","show-pupover":""}})}}])}),s("ExportToExcel",{attrs:{"file-name":"lista socios con descuentos no registrados","json-list":e.list1}})],1),s("el-col",{attrs:{span:11,offset:0}},[e._v(" Lista Documento 2 "),s("el-select",{attrs:{placeholder:"seleccione las columnas",clearable:"",multiple:""},model:{value:e.showKeysList2,callback:function(t){e.showKeysList2=t},expression:"showKeysList2"}},e._l(e.list2.length>0?Object.keys(e.list2[0]):[],(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1),s("br"),s("array-paginate",{attrs:{list:e.list2,filterable:"","on-select":e.onSelectl2},scopedSlots:e._u([{key:"default",fn:function(t){return s("show-object",{attrs:{object:t.item,"principal-keys":e.showKeysList2,type:"error","show-pupover":""}})}}])}),s("ExportToExcel",{attrs:{"file-name":"lista personal sin descuento","json-list":e.list2}})],1)],1),e._m(0),s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:10,offset:0}},[e._v(" Registro de Lista 1 "),s("show-object",{attrs:{object:e.l1select,"principal-keys":e.showKeysList1,type:"info","show-pupover":""}})],1),s("el-col",{attrs:{span:3,offset:0}},[e.l1select&&e.l2select?s("el-button",{attrs:{type:"success",size:"default"},on:{click:e.onMatch}},[e._v("Emparejar")]):e._e()],1),s("el-col",{attrs:{span:10,offset:0}},[e._v(" Registro de Lista 2 "),s("show-object",{attrs:{object:e.l2select,"principal-keys":e.showKeysList2,type:"info","show-pupover":""}})],1)],1)],1)},Ie=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("h3",[s("span",[e._v("Registros Seleccionados Para Emparejar Manualmente")])])}],Pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._v(" Exportar a Excel "),s("el-button",{attrs:{type:"success",size:"default"},on:{click:e.onExport}},[e._v(" Guardar como Excel ")])],1)},Me=[],Fe={name:"ExportToExcel",props:{fileName:{type:String,default:"excel-list"},jsonList:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{onExport:function(){if(this.jsonList.length>0){var e=Object.keys(this.jsonList[0]),t=this.jsonList.map((function(e){return Object.keys(e).map((function(t){return e[t]}))}));Ke({header:e,data:t,filename:this.fileName})}else this.$message({message:"La lista a exportar esta vacia!!!",type:"info",showClose:!0,duration:5e3})}}},Be=Fe,$e=Object(p["a"])(Be,Pe,Me,!1,null,null,null),ze=$e.exports,Ue={name:"NoMatchLists",props:{list1:{type:Array,default:function(){return[]}},list2:{type:Array,default:function(){return[]}}},components:{ArrayPaginate:N,ShowObject:_,ExportToExcel:ze},data:function(){return{showKeysList1:[],showKeysList2:[],l1select:null,l2select:null}},methods:{onMatch:function(){this.$emit("on-matched",{d1:this.l1select,d2:this.l2select}),this.l1select=null,this.l2select=null},onSelectl1:function(e){this.l1select=e},onSelectl2:function(e){this.l2select=e}}},Ge=Ue,Je=Object(p["a"])(Ge,Te,Ie,!1,null,null,null),qe=Je.exports,Ve=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.list.length>0?s("div",[s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:11,offset:0}},[s("el-select",{attrs:{placeholder:"seleccione las columnas",clearable:"",multiple:""},model:{value:e.showKeysListd1,callback:function(t){e.showKeysListd1=t},expression:"showKeysListd1"}},e._l(e.list.length>0?Object.keys(e.list[0].d1):[],(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),s("el-col",{attrs:{span:11,offset:0}},[s("el-select",{attrs:{placeholder:"seleccione las columnas",clearable:"",multiple:""},model:{value:e.showKeysListd2,callback:function(t){e.showKeysListd2=t},expression:"showKeysListd2"}},e._l(e.list.length>0?Object.keys(e.list[0].d2):[],(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),s("br"),s("array-paginate",{attrs:{list:e.list},scopedSlots:e._u([{key:"default",fn:function(t){return s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:10,offset:0}},[s("show-object",{attrs:{object:t.item.d1,type:"info","principal-keys":e.showKeysListd1.length>0?e.showKeysListd1:null,"show-area-info":""}})],1),s("el-col",{attrs:{span:3,offset:0}},[s("el-popover",{attrs:{placement:"top",title:"Confirmar",trigger:"hover"}},[s("el-button",{attrs:{slot:"reference",icon:"el-icon-check",type:"success",size:"small",circle:""},on:{click:function(s){return e.onConfirm(t)}},slot:"reference"})],1),s("el-popover",{attrs:{placement:"top",title:"Confirmar",trigger:"hover"}},[s("el-button",{attrs:{slot:"reference",icon:"el-icon-close",type:"danger",size:"small",circle:""},on:{click:function(s){return e.onDelete(t)}},slot:"reference"})],1)],1),s("el-col",{attrs:{span:10,offset:0}},[s("show-object",{attrs:{object:t.item.d2,type:"info","principal-keys":e.showKeysListd2.length>0?e.showKeysListd2:null,"show-area-info":""}})],1)],1)}}],null,!1,320975168)})],1):e._e()},We=[],He={name:"PossibleMatchList",components:{ArrayPaginate:N,ShowObject:_},props:{list:{type:Array,default:function(){return[]}}},data:function(){return{showKeysListd1:[],showKeysListd2:[]}},methods:{onConfirm:function(e){this.$emit("on-confirm",Object(V["a"])({},e))},onDelete:function(e){this.$emit("on-delete",Object(V["a"])({},e))}}},Ye=He,Ze=(s("cb7b"),Object(p["a"])(Ye,Ve,We,!1,null,null,null)),Qe=Ze.exports,Xe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-button",{attrs:{type:"primary",size:"default"},on:{click:e.onShowDialog}},[e._v("Cambiar montos en Planilla UATF")]),s("el-dialog",{attrs:{title:"Cambiar montos en Planilla UATF",visible:e.showDialog,width:"50%"},on:{"update:visible":function(t){e.showDialog=t}}},[s("upload-excel",{on:{"on-read-worbook":e.onReadWorkBook}}),s("el-form",{attrs:{"label-width":"150px"}},[s("el-form-item",{attrs:{label:"Lista Campo Item"}},[s("el-select",{attrs:{placeholder:"seleccione el campo como item",clearable:""},model:{value:e.itemKey,callback:function(t){e.itemKey=t},expression:"itemKey"}},e._l(e.listKeys,(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),s("el-form-item",{attrs:{label:"Lista Campo TOTAL"}},[s("el-select",{attrs:{placeholder:"seleccione el campo como TOTAL",clearable:""},model:{value:e.totalKey,callback:function(t){e.totalKey=t},expression:"totalKey"}},e._l(e.listKeys,(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),s("el-form-item",{attrs:{label:"Columna Campo Item"}},[s("el-input",{attrs:{type:"text",placeholder:"",size:"normal",clearable:""},model:{value:e.itemCol,callback:function(t){e.itemCol=t},expression:"itemCol"}})],1),s("el-form-item",{attrs:{label:"Columna Campo Monto"}},[s("el-input",{attrs:{type:"text",placeholder:"",size:"normal",clearable:""},model:{value:e.totalCol,callback:function(t){e.totalCol=t},expression:"totalCol"}})],1),s("el-form-item",{attrs:{label:"Numero de fila del primer Registro"}},[s("el-input",{attrs:{type:"number",placeholder:"Fila ",size:"normal",clearable:""},model:{value:e.frr,callback:function(t){e.frr=t},expression:"frr"}})],1),s("el-form-item",{attrs:{label:"Numero de fila del ultimo Registro"}},[s("el-input",{attrs:{type:"number",placeholder:"Fila ",size:"normal",clearable:""},model:{value:e.er,callback:function(t){e.er=t},expression:"er"}})],1)],1),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("Cancel")]),s("el-button",{attrs:{type:"primary"},on:{click:e.onInitInyect}},[e._v("Cambiar")])],1)],1)],1)},et=[];s("0fd4");var tt=function(e,t){return saveAs(e,t)},st=tt,nt={components:{uploadExcel:ae},name:"InyectToExcel",props:{list:{type:Array,default:function(){return[]}},firstRow:{type:Number,default:1},ik:{type:String,default:""},tk:{type:String,default:""},ic:{type:String,default:""},tc:{type:String,default:""}},watch:{list:function(e){e&&e.length?this.listKeys=Object.keys(e[0]):this.listKeys=[]}},data:function(){return{workbook:null,showDialog:!1,listKeys:[],itemKey:"",totalKey:"",itemCol:"",totalCol:"",frr:1,er:1505}},created:function(){this.itemKey=this.ik,this.totalKey=this.tk,this.itemCol=this.ic,this.totalCol=this.tc,this.frr=this.firstRow,this.list&&this.list.length?this.listKeys=Object.keys(this.list[0]):this.listKeys=[]},methods:{saveAS:function(e,t){return st(e,t)},onShowDialog:function(){this.showDialog=!0},onInitInyect:function(){for(var e=this,t=this.list.map((function(t){return t[e.itemKey]})),s=this.workbook.SheetNames[0],n=this.frr;n<=this.er;n++){var l=this.itemCol.concat(String(n)),i=this.totalCol.concat(String(n));if(this.workbook.Sheets[s][l]){var o=t.indexOf(this.workbook.Sheets[s][l].v);this.workbook.Sheets[s][i]=-1!==o?this.gennDataInyect(this.list[o][this.totalKey],"n"):this.gennDataInyect("","s")}}this.saveWB(this.workbook,"DECIENTOS UATF DICIEMBRE 2020")},onReadWorkBook:function(e){this.workbook=e},gennDataInyect:function(e,t){return{v:e,t:t,w:e}},saveWB:function(e,t){var s=X.a.write(e,{bookType:"xlsx",bookSST:!1,type:"binary"});st(new Blob([this.s2ab(s)],{type:"application/octet-stream"}),"".concat(t,".","xlsx"))},s2ab:function(e){for(var t=new ArrayBuffer(e.length),s=new Uint8Array(t),n=0;n!=e.length;++n)s[n]=255&e.charCodeAt(n);return t}}},lt=nt,it=Object(p["a"])(lt,Xe,et,!1,null,null,null),ot=it.exports,at={name:"MatchInfo",components:{ArrayPaginate:N,ShowObject:_,NoMatchedLists:qe,PossibleMatchList:Qe,GenerateAdvancedReport:Oe,InyectToExcel:ot},props:{arr1:{type:Array,default:function(){return[]}},arr2:{type:Array,default:function(){return[]}}},data:function(){return{list1:[],list2:[],matchList:[],possibleMatchList:[],hasNoMatched:!1,showResults:!1,arrAlgoComp:[{name:"Carnet de Identidad",id:1},{name:"Nombre",id:2},{name:"Valor Unico",id:3}],algoSelect:null,l1CompareKeys:[],l2CompareKeys:[]}},computed:{genMLjoinObj:function(){return this.matchList?this.matchList.map((function(e){return H(e,["d1","d2"])})):[]}},watch:{arr1:function(){this.initComponents()},arr2:function(){this.initComponents()},matchList:function(e){this.$emit("on-match",e)}},created:function(){this.initComponents()},methods:{PMLonConfirm:function(e){this.matchList.push(e.item),this.possibleMatchList=this.possibleMatchList.filter((function(t,s){return e.index!==s}))},PMLonDelete:function(e){this.list1.push(e.item.d1),this.list2.push(e.item.d2),this.possibleMatchList=this.possibleMatchList.filter((function(t,s){return e.index!==s}))},compareObjects:function(e,t){if(e&&t){var s=Object.keys(e),n=Object.keys(t);if(s.length!==n.length)return!1;for(var l=0,i=s;l<i.length;l++){var o=i[l];if(e[o]!==t[o])return!1}return!0}return!1},onMatchNM:function(e){var t=this;this.list1=this.list1.filter((function(s){return!t.compareObjects(e.d1,s)})),this.list2=this.list2.filter((function(s){return!t.compareObjects(e.d2,s)})),this.matchList.push(e)},initComponents:function(){this.list1=this.arr1,this.list2=this.arr2,this.matchList=[],this.possibleMatchList=[],this.hasNoMatched=!1,this.showResults=!1},getKeysList:function(e){return e.length>0?Object.keys(e[0]):[]},matching:function(){var e=this,t=this;this.l1CompareKeys.length>0&&this.l2CompareKeys.length>0&&this.algoSelect?(this.list1=this.list1.filter((function(s){var n=!1;return e.list2=e.list2.filter((function(e){return!!n||(!t.compareWithAlgoComp(s,e,t.algoSelect)||(n=!0,!1))})),!n})),this.showResults=!0,this.hasNoMatched=this.list1.length>0||this.list2.length>0):this.$message({message:"seleccione almenos 1 para cada campo",type:"warning",showClose:!0,duration:5e3})},compareWithAlgoComp:function(e,t,s){switch(s){case 1:switch(De.compareCI(e[this.l1CompareKeys[0]],t[this.l2CompareKeys[0]])){case 1:return this.matchList.push(this.registerMatch(e,t)),!0;case 0:return this.possibleMatchList.push(this.registerMatch(e,t)),!0;case-1:return!1}break;case 2:return!!De.compareNames(this.l1CompareKeys.map((function(t){return e[t]})),this.l2CompareKeys.map((function(e){return t[e]})))&&(this.matchList.push(this.registerMatch(e,t)),!0);case 3:return String(e[this.l1CompareKeys[0]]).toUpperCase()===String(t[this.l2CompareKeys[0]]).toUpperCase()&&(this.matchList.push(this.registerMatch(e,t)),!0)}},registerMatch:function(e,t){return{d1:e,d2:t}}}},rt=at,ct=Object(p["a"])(rt,ye,ge,!1,null,null,null),ut=ct.exports,ft=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.matchList.length>0?s("div",[s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:9,offset:0}},[s("el-select",{attrs:{placeholder:"seleccione una columna",clearable:""},model:{value:e.validKeysd1,callback:function(t){e.validKeysd1=t},expression:"validKeysd1"}},e._l(e.matchList.length>0?Object.keys(e.matchList[0].d1):[],(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),s("el-col",{attrs:{span:5,offset:0}},[s("el-select",{attrs:{placeholder:"seleccione la comparacion",clearable:""},model:{value:e.validTask,callback:function(t){e.validTask=t},expression:"validTask"}},e._l(e.listValidRules,(function(e){return s("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1),s("br"),s("br"),s("el-button",{attrs:{type:"default",size:"default"},on:{click:e.newTaskVaild}},[e._v("Añadir Verificacion")]),s("br"),s("br"),s("el-button",{attrs:{type:"success",size:"default"},on:{click:e.initFilter}},[e._v("Iniciar Revicion")]),s("br"),s("el-button",{attrs:{type:"danger",size:"default"},on:{click:e.reset}},[e._v("Reiniciar")])],1),s("el-col",{attrs:{span:9,offset:0}},[s("el-select",{attrs:{placeholder:"seleccione una columna",clearable:""},model:{value:e.validKeysd2,callback:function(t){e.validKeysd2=t},expression:"validKeysd2"}},e._l(e.matchList.length>0?Object.keys(e.matchList[0].d2):[],(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),e.successList.length>0||e.errorList.length>0?s("div",[s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:11,offset:0}},[s("el-select",{attrs:{placeholder:"seleccione las columnas",clearable:"",multiple:""},model:{value:e.showKeysListd1,callback:function(t){e.showKeysListd1=t},expression:"showKeysListd1"}},e._l(e.matchList.length>0?Object.keys(e.matchList[0].d1):[],(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),s("el-col",{attrs:{span:11,offset:0}},[s("el-select",{attrs:{placeholder:"seleccione las columnas",clearable:"",multiple:""},model:{value:e.showKeysListd2,callback:function(t){e.showKeysListd2=t},expression:"showKeysListd2"}},e._l(e.matchList.length>0?Object.keys(e.matchList[0].d2):[],(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),s("br"),s("el-collapse",{attrs:{accordion:!0}},[e.successList.length>0?s("el-collapse-item",[s("span",{attrs:{slot:"title"},slot:"title"},[s("el-badge",{attrs:{value:e.successList.length,type:"success",hidden:!1}},[s("el-link",{attrs:{type:"success",underline:!1}},[e._v("Registro Iguales")])],1)],1),s("array-paginate",{attrs:{list:e.successList},scopedSlots:e._u([{key:"default",fn:function(t){return s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:8,offset:0}},[s("show-object",{attrs:{object:t.item.d1,"principal-keys":e.showKeysListd1,type:"success","show-area-info":""}})],1),s("el-col",{attrs:{span:8,offset:0}},[s("show-object",{attrs:{object:t.item.d2,"principal-keys":e.showKeysListd2,type:"success","show-area-info":""}})],1),s("el-col",{attrs:{span:6,offset:0}},[s("show-object",{attrs:{object:t.item.success,"show-all":"",type:"success","show-area-info":""}})],1)],1)}}],null,!1,1994374322)}),s("GenerateAdvancedReport",{attrs:{list:e.successList,"extract-sub-objects":["d1","d2","success"]}})],1):e._e(),e.errorList.length>0?s("el-collapse-item",[s("span",{attrs:{slot:"title"},slot:"title"},[s("el-badge",{attrs:{value:e.errorList.length,hidden:!1}},[s("el-link",{attrs:{type:"danger",underline:!1}},[e._v("Registro Diferentes")])],1)],1),s("array-paginate",{attrs:{list:e.errorList},scopedSlots:e._u([{key:"default",fn:function(t){return s("el-row",{attrs:{gutter:20,type:"flex",justify:"space-around"}},[s("el-col",{attrs:{span:8,offset:0}},[s("show-object",{attrs:{object:t.item.d1,"principal-keys":e.showKeysListd1,type:"error","show-area-info":""}})],1),s("el-col",{attrs:{span:8,offset:0}},[s("show-object",{attrs:{object:t.item.d2,"principal-keys":e.showKeysListd2,type:"error","show-area-info":""}})],1),s("el-col",{attrs:{span:6,offset:0}},[s("show-object",{attrs:{object:t.item.error,type:"error","show-area-info":""}})],1)],1)}}],null,!1,1682394955)}),s("GenerateAdvancedReport",{attrs:{list:e.errorList,"extract-sub-objects":["d1","d2","error"]}})],1):e._e()],1),e.acumTaskResult?s("el-row",{attrs:{gutter:20,type:"flex",justify:"end"}},[s("el-col",{attrs:{span:10,offset:0}},[s("show-object",{attrs:{object:e.acumTaskResult,"principal-keys":["title"],type:e.acumTaskResult.type,"hide-keys":["title","type"],"show-area-info":""}})],1)],1):e._e()],1):e._e()],1):e._e()},dt=[],ht={name:"ValidateData",props:{matchList:{type:Array,default:function(){return[]}}},components:{ArrayPaginate:N,ShowObject:_,GenerateAdvancedReport:Oe},data:function(){return{showKeysListd1:[],showKeysListd2:[],listValidRules:[{id:1,label:"comparacion de igualdad"},{id:2,label:"Suma total y Comparacion"}],validKeysd1:null,validKeysd2:null,validTask:null,tasks:[],successList:[],errorList:[],acumTaskResult:null,reporListError:null}},watch:{matchList:function(e){this.tasks>0&&e&&this.initFilter()}},methods:{onRefactorListError:function(e){this.reporListError=e},reset:function(){this.successList=[],this.errorList=[],this.acumTaskResult=null,this.tasks=[]},initFilter:function(){if(this.tasks.length>0){var e=this.tasks.filter((function(e){return 1===e.vrId})),t=this.tasks.filter((function(e){return 2===e.vrId}));e=e.length>0?e[0]:null,t=t.length>0?t[0]:null,this.validateTasks(e,t)}else this.$message({message:"No tiene ninguna Regla de Validacion registrada!!!",type:"warning",showClose:!0,duration:5e3})},newTaskVaild:function(){this.validTask&&this.validKeysd1&&this.validKeysd2?(this.tasks.push({ks1:this.validKeysd1,ks2:this.validKeysd2,vrId:this.validTask}),this.onAddTask()):this.$message({message:"todos los select deben tener un valor seleccionado!!",type:"warning",showClose:!0,duration:5e3})},onAddTask:function(){this.validKeysd1=null,this.validKeysd2=null,this.validTask=null},validateTasks:function(e,t){var s=this,n=0,l=0;this.errorList=[],this.successList=[],this.matchList.forEach((function(i){if(t&&(n+=i.d1[t.ks1],l+=i.d2[t.ks2]),e)if(s.verifyTaskEquals(i.d1,i.d2,e)){var o={success:{},d1:i.d1,d2:i.d2};o.success[e.ks1]=i.d1[e.ks1],o.success[e.ks2]=i.d2[e.ks2],s.successList.push(o)}else{var a={error:{},d1:i.d1,d2:i.d2};a.error[e.ks1]=i.d1[e.ks1],a.error[e.ks2]=i.d2[e.ks2],s.errorList.push(a)}})),t&&(this.acumTaskResult={title:"Total Suma ("+t.ks1+" + "+t.ks2+")",type:n===l?"success":"error",resultado:(n===l?"":"No ")+"Son Iguales"},this.acumTaskResult["TOTAL "+t.ks1]=n,this.acumTaskResult["TOTAL "+t.ks2]=l)},verifyTaskEquals:function(e,t,s){return e[s.ks1]===t[s.ks2]}}},pt=ht,mt=Object(p["a"])(pt,ft,dt,!1,null,null,null),yt=mt.exports,gt={name:"CompararPlanillas",components:{FilterExcelColumns:fe,MatchInfo:ut,ValidateData:yt,LoadCoopPlanillas:me,ShowObject:_,ArrayPaginate:N},data:function(){return{xlsx1:{title:"Palanillas De Descuento Cooperativa",info:null},xlsx2:{title:"Seleccione Nomina de Personal UATF",filterColumns:[{oldKey:"B",newKey:"CARRERA"},{oldKey:"C",newKey:"TIPO"},{oldKey:"D",newKey:"COD PRG"},{oldKey:"E",newKey:"ITEM"},{oldKey:"F",newKey:"CI"},{oldKey:"G",newKey:"APELLIDOS Y NOMBRES"},{oldKey:"H",newKey:"CARGO"},{oldKey:"I",newKey:"DEDI"},{oldKey:"J",newKey:"TIPO CARGO"},{oldKey:"K",newKey:"N. DOC"},{oldKey:"L",newKey:"MONTO"}],noNullColumns:["G","L"],uniqueColumns:["CI"],firstRow:4,info:null},matchList:[]}},methods:{onFilterD1:function(e){this.xlsx1.info=e},onFilterD2:function(e){this.xlsx2.info=e},onGenerateMatchList:function(e){this.matchList=e}}},bt=gt,vt=(s("41a0"),Object(p["a"])(bt,v,w,!1,null,"d33d146c",null)),wt=vt.exports,Ct={name:"Home",components:{CompararPlanillas:wt}},Lt=Ct,kt=Object(p["a"])(Lt,g,b,!1,null,null,null),Kt=kt.exports,xt={template:"<div>foo</div>"},_t={template:"<div>bar</div>"},jt=[{path:"/",name:"home",component:Kt},{path:"/foo",component:xt},{path:"/bar",component:_t}],Ot=new o["a"]({routes:jt}),Et=Ot;i["default"].use(a["a"]);var At=new a["a"].Store({state:{errors:[]},mutations:{setErrors:function(e,t){e.errors=t}},getters:{allErrors:function(e){return e.errors}}}),St=At;i["default"].use(l.a,{locale:c.a}),i["default"].use(o["a"]),i["default"].use(a["a"]),i["default"].config.productionTip=!1,new i["default"]({render:function(e){return e(y)},router:Et,store:St}).$mount("#app")},"6fd0":function(e,t,s){},"7b86":function(e,t,s){},"82b2":function(e,t,s){},"85ec":function(e,t,s){},"8cd1":function(e,t,s){},"97af":function(e,t,s){"use strict";s("7b86")},"9fcc":function(e,t,s){},a17f:function(e,t,s){"use strict";s("9fcc")},ac68:function(e,t,s){"use strict";s("82b2")},cb7b:function(e,t,s){"use strict";s("5276")},d4f9:function(e,t,s){e.exports=s.p+"img/icono_app_sm.f1565e79.png"}});
//# sourceMappingURL=app.9134dc6f.js.map